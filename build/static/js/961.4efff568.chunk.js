"use strict";(self.webpackChunkioms_web=self.webpackChunkioms_web||[]).push([[961],{75697:function(n,e,t){t.d(e,{An:function(){return f},CI:function(){return a},Rn:function(){return h},Tj:function(){return l},Vo:function(){return m},gg:function(){return d},oB:function(){return p},un:function(){return Z}});var r=t(61805),i=t(66212),o=t(22098),s=t(54427),u=t(77841),c=t(46417),a=function(n){return n?(0,c.jsx)(i.Z,{color:"success",label:"Taken"}):(0,c.jsx)(i.Z,{color:"primary",label:"Open"})},l=function(n){return n===r.yd.PENDING?(0,c.jsx)(i.Z,{color:"secondary",label:"Pending"}):n===r.yd.ACCEPTED?(0,c.jsx)(i.Z,{color:"success",label:"Accepted"}):n===r.yd.REJECTED?(0,c.jsx)(i.Z,{color:"error",label:"Rejected"}):void 0},d=function(n){return new Date(n).toLocaleString()},f=function(n){return 1===n?"Admin":2===n?"User":void 0},h=function(n){(0,o.nD)().then((function(e){console.log(e),n(e)})).catch((function(n){console.log(n)}))},p=function(n){return n.toLocaleString("en-US",{style:"currency",currency:"TZS"})},m=function(n){n.response?401===n.response.status?(u.Z.error("Unauthorized request, please login again"),null!==s.VK&&(0,s.VK)("/login",{replace:!0}),localStorage.clear()):400===n.response.status||500===n.response.status||n.response&&429===n.response.status||console.log("Error occurred, status: "+n.response.status):u.Z.error("No network available, Please connect to a Network")};function Z(n){var e=n.slice(0,3),t=n.slice(3);return 9===t.length?{countryCode:e,phoneNumber:t}:{countryCode:"255",phoneNumber:"1".repeat(9)}}},77841:function(n,e,t){var r=t(15671),i=t(43144),o=t(54427),s=function(){function n(){(0,r.Z)(this,n)}return(0,i.Z)(n,[{key:"success",value:function(n){o.sp&&o.sp.enqueueSnackbar(n,{variant:"success"})}},{key:"error",value:function(n){o.sp&&o.sp.enqueueSnackbar(n,{variant:"error"})}},{key:"warning",value:function(n){o.sp&&o.sp.enqueueSnackbar(n,{variant:"warning"})}}]),n}();e.Z=new s},61961:function(n,e,t){t.r(e);var r=t(70885),i=t(57829),o=t(47313),s=t(22098),u=t(77841),c=t(58467),a=t(37401),l=t(97402),d=t(46417);e.default=function(){var n=(0,o.useState)(!1),e=(0,r.Z)(n,2),t=e[0],f=e[1],h=(0,c.s0)();return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(l.Z,{title:"Adding role",content:!1,border:!1,boxShadow:!0,children:(0,d.jsx)(i.Z,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:(0,d.jsx)(a.Z,{onSubmitForm:function(n){return function(n){(0,s.kA)(n).then((function(n){console.log("Response",n),u.Z.success("Role was successfully added"),h("/roles",{replace:!0})})).catch((function(n){f(!1),console.log(n),u.Z.error("Failed to add Role")}))}(n)},loading:t})})})})}},37401:function(n,e,t){t.d(e,{Z:function(){return P}});var r=t(74165),i=t(15861),o=t(1413),s=t(70885),u=t(9019),c=t(42832),a=t(23306),l=t(37843),d=t(15480),f=t(19536),h=t(7410),p=t(28089),m=t(47313),Z=t(57829),g=t(46330),v=t(83929),x=t(46417);function k(n){var e=n.permissions,t=void 0===e?[]:e,r=n.title,i=n.onChangePermissionHandler,s=(0,x.jsx)(Z.Z,{sx:{display:"flex",flexDirection:"column",ml:3},children:t.map((function(n,e){return(0,x.jsx)(v.Z,{label:n.label,control:(0,x.jsx)(g.Z,{checked:n.checked,onChange:function(n){return t=n,r=e,console.log(t,r),void i((function(n){return n.map((function(n,e){return e===r?(0,o.Z)((0,o.Z)({},n),{},{checked:!n.checked}):n}))}));var t,r}})},e)}))});return(0,x.jsxs)("div",{children:[(0,x.jsx)(v.Z,{label:r,control:(0,x.jsx)(g.Z,{checked:t.every((function(n){return!0===n.checked})),indeterminate:t.some((function(n){return!0===n.checked})),onChange:function(n){var e=n.target.checked;i((function(n){return n.map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:e})}))}))}})}),s]})}var b=t(69490),j=t(51406),C=t(77841),S=t(99743),P=function(n){var e=n.intialPermissions,t=void 0===e?[]:e,Z=n.onSubmitForm,g=n.loading,v=n.title,P=void 0===v?"":v;console.log(t,t.includes("1"));var y=(0,m.useState)(S.k.userCRUD_permissions().map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:t.includes(n.value)})}))),w=(0,s.Z)(y,2),D=w[0],R=w[1],E=(0,m.useState)(S.k.blCRUD_permissions().map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:t.includes(n.value)})}))),U=(0,s.Z)(E,2),A=U[0],T=U[1],N=(0,m.useState)(S.k.bl_chargesCRUD_permissions().map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:t.includes(n.value)})}))),_=(0,s.Z)(N,2),V=_[0],q=_[1],H=(0,m.useState)(S.k.vouchersCRUD_permissions().map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:t.includes(n.value)})}))),I=(0,s.Z)(H,2),B=I[0],F=I[1],J=(0,m.useState)(S.k.floatRequestCRUD_permissions().map((function(n){return(0,o.Z)((0,o.Z)({},n),{},{checked:t.includes(n.value)})}))),O=(0,s.Z)(J,2),z=O[0],W=O[1];return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(h.J9,{initialValues:{title:P,permissions:[],submit:null},validationSchema:p.Ry().shape({title:p.Z_().max(255).required("Title is required")}),onSubmit:function(){var n=(0,i.Z)((0,r.Z)().mark((function n(e,t){var i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.setErrors,t.setStatus,t.setSubmitting,0!=(i=D.concat(A,V,B,z).filter((function(n){return!0===n.checked})).map((function(n){return n.value}))).length){n.next=5;break}return C.Z.warning("Atleast one permission must be chosen"),n.abrupt("return");case 5:e.permissions=i,Z(e);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),children:function(n){var e=n.errors,t=n.handleBlur,r=n.handleChange,i=n.handleSubmit,o=(n.isSubmitting,n.touched),s=n.values;return(0,x.jsxs)("form",{noValidate:!0,onSubmit:i,children:[(0,x.jsx)(u.ZP,{container:!0,spacing:3,mb:3,children:(0,x.jsx)(u.ZP,{item:!0,xs:6,children:(0,x.jsxs)(c.Z,{spacing:1,children:[(0,x.jsx)(a.Z,{htmlFor:"bootstrap",children:"Role Title"}),(0,x.jsx)(l.Z,{id:"email-login",type:"text",value:s.title,name:"title",onBlur:t,onChange:r,placeholder:"eg. Admin",fullWidth:!0,error:Boolean(o.title&&e.title)}),o.title&&e.title&&(0,x.jsx)(d.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:e.title})]})})}),(0,x.jsx)(f.Z,{light:!0,variant:"fullWidth",mb:3,children:"Permissions Manager"}),(0,x.jsxs)(u.ZP,{container:!0,spacing:3,mb:3,p:3,children:[(0,x.jsx)(u.ZP,{item:!0,xs:3,children:(0,x.jsx)(k,{title:"Users CRUD",permissions:D,onChangePermissionHandler:R})}),(0,x.jsx)(u.ZP,{item:!0,xs:3,children:(0,x.jsx)(k,{title:"Bls CRUD",permissions:A,onChangePermissionHandler:T})}),(0,x.jsx)(u.ZP,{item:!0,xs:3,children:(0,x.jsx)(k,{title:"Bl Charges CRUD",permissions:V,onChangePermissionHandler:q})}),(0,x.jsx)(u.ZP,{item:!0,xs:3,children:(0,x.jsx)(k,{title:"Vouchers CRUD",permissions:B,onChangePermissionHandler:F})}),(0,x.jsx)(u.ZP,{item:!0,xs:3,children:(0,x.jsx)(k,{title:"Float Request CRUD",permissions:z,onChangePermissionHandler:W})})]}),(0,x.jsx)(u.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",mg:3,children:(0,x.jsx)(u.ZP,{item:!0,xs:6,children:(0,x.jsx)(b.Z,{children:(0,x.jsx)(j.Z,{disableElevation:!0,loading:g,disabled:g,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:"Submit"})})})})]})}})})}},22098:function(n,e,t){t.d(e,{LK:function(){return j},kA:function(){return g},bu:function(){return v},Um:function(){return m},Bf:function(){return b},Ar:function(){return k},vU:function(){return x},nD:function(){return Z},gi:function(){return p},rW:function(){return f},Qb:function(){return l},OP:function(){return h},yi:function(){return C},vy:function(){return d}});var r=t(56573),i="http://161.35.210.153:8500/",o=t(75697);function s(n,e){return new Promise((function(t,s){r.Z.post(i+n,e).then((function(n){n.headers,t(n.data)})).catch((function(n){(0,o.Vo)(n),s(n)}))}))}function u(n){return new Promise((function(e,t){r.Z.get(i+n,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){e(n.data)})).catch((function(n){(0,o.Vo)(n),t(n)}))}))}function c(n,e){return new Promise((function(t,s){r.Z.post(i+n,e,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){t(n.data)})).catch((function(n){(0,o.Vo)(n),s(n)}))}))}function a(n,e){return new Promise((function(t,s){r.Z.put(i+n,e,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){t(n.data)})).catch((function(n){(0,o.Vo)(n),s(n)}))}))}function l(n,e){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r={};return""!==t&&(r.mfaCode=t),s("api/auth/login-user",{email:n,password:e},!1)}function d(n,e,t){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i={};return""!==r&&(i.mfaCode=r),c("api/auth/reset-password/"+t,{password:n,confirm_password:e},!1)}function f(){return u("api/v1/users-list/")}function h(n){return c("api/v1/register-user",n)}function p(n){return u("api/v1/user/"+n)}function m(n,e){return a("api/v1/user/"+n,e)}function Z(){return u("api/v1/roles")}function g(n){return c("api/v1/roles",n)}function v(n,e){return a("api/v1/role/"+n,e)}function x(n){return u("api/v1/role/"+n)}function k(){return u("api/v1/hostels-list/")}function b(){return u("api/v1/booked-hostels-list/")}function j(n){return a("api/v1/accept-hostel-book/"+n,{})}function C(n){return a("api/v1/reject-hostel-book/"+n,{})}},61805:function(n,e,t){t.d(e,{J:function(){return i},yd:function(){return r}});var r={PENDING:0,ACCEPTED:1,REJECTED:2},i={TODAY:"today",THIS_WEEK:"this_week",MONTHLY:"monthly"}}}]);