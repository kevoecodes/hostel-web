"use strict";(self.webpackChunkioms_web=self.webpackChunkioms_web||[]).push([[2179],{3797:function(e,t,n){n(47313),n(40621);var r=n(95795),s=n(55585),i=n(69099),o=n(58467),c=n(46417);t.Z=function(e){var t=e.children,n=e.permission,a=e.unauthorized_page,l=void 0!==a&&a,u=e.withOtherDeps,d=void 0===u?function(){return!0}:u,h=(0,o.s0)();return(0,c.jsx)(c.Fragment,{children:r.Z.has_permission(n)&&d()?t:l?(0,c.jsx)(s.ZP,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:(0,c.jsx)(i.Z,{onClick:function(){h("/",{replace:!0})},type:"primary",children:"Back Home"})}):(0,c.jsx)(c.Fragment,{children:" "})})}},54214:function(e,t,n){n.d(t,{_i:function(){return A},XN:function(){return S},fL:function(){return D}});var r=n(74165),s=n(15861),i=n(29439),o=n(66149),c=n(33604),a=n(96467),l=n(63366),u=n(87462),d=n(47313),h=n(83061),x=n(21921),j=n(17592),f=n(77342),m=n(61113),p=n(77430),g=n(32298);function Z(e){return(0,g.Z)("MuiDialogContentText",e)}(0,p.Z)("MuiDialogContentText",["root"]);var v=n(46417),y=["children","className"],_=(0,j.ZP)(m.Z,{shouldForwardProp:function(e){return(0,j.FO)(e)||"classes"===e},name:"MuiDialogContentText",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),b=d.forwardRef((function(e,t){var n=(0,f.Z)({props:e,name:"MuiDialogContentText"}),r=n.className,s=(0,l.Z)(n,y),i=function(e){var t=e.classes,n=(0,x.Z)({root:["root"]},Z,t);return(0,u.Z)({},t,n)}(s);return(0,v.jsx)(_,(0,u.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:s,className:(0,h.Z)(i.root,r)},n,{classes:i}))})),E=n(83929),P=n(46330),C=n(4117),R=n(69099),F=n(61805),S={BL_CHARGE:{title:"BL Charge"},VOUCHER:{title:"Voucher"}},V=function(e){var t=e.action;return(0,v.jsxs)(v.Fragment,{children:["You are about to ",(0,v.jsx)("span",{style:{fontWeight:"bolder"},children:t})," "]})},A={VERIFY:{value:F.SU.VERIFIED,prompt_text:(0,v.jsx)(V,{action:"VERIFY"})},APPROVE:{value:F.SU.APPROVED,prompt_text:(0,v.jsx)(V,{action:"APPROVE"})},PAYMENTS:{value:F.SU.PAID,prompt_text:(0,v.jsx)(V,{action:"MAKE PAYMENTS"})},REJECT:{value:F.SU.REJECTED,prompt_text:(0,v.jsx)(V,{action:"REJECT"})}},D=function(e){var t=e.open,n=e.setOpen,l=e.unique_identifier,u=e.request_type,h=e.action,x=e.onConfirm,j=(0,d.useState)(!1),f=(0,i.Z)(j,2),p=f[0],g=f[1],Z=(0,d.useState)(!1),y=(0,i.Z)(Z,2),_=y[0],F=y[1],S=function(){n(!1),g(!1)},V=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),e.next=3,x();case 3:t=e.sent,console.log("Success returned ",t),t&&S();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(o.Z,{fullWidth:!0,maxWidth:"xs",open:t,onClose:S,children:[(0,v.jsx)(c.Z,{children:"Are you sure"}),(0,v.jsx)(a.Z,{children:(0,v.jsxs)(b,{children:[(0,v.jsxs)("div",{children:[h.prompt_text," ",u.title," ",(0,v.jsx)("span",{style:{fontWeight:"bolder"},children:l}),", tick the box below if you are sure of this action"]}),(0,v.jsx)(E.Z,{control:(0,v.jsx)(P.Z,{checked:p,onChange:function(e){return g(e.target.checked)},name:"checked",color:"primary",size:"small"}),label:(0,v.jsx)(m.Z,{variant:"h6",children:"I am sure"})})]})}),(0,v.jsxs)(C.Z,{children:[(0,v.jsx)(R.Z,{color:"secondary",onClick:S,children:"Close"}),(0,v.jsx)(R.Z,{disabled:!p||_,onClick:V,children:"Yes"})]})]})})}},52179:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var r=n(29439),s=n(40621),i=n(9019),o=n(57829),c=n(75697),a=n(98466),l=n(61805),u=n(47313),d=n(58467),h=n(36594),x=n(77841),j=n(69099),f=n(19536),m=n(61113),p=n(42832),g=n(73319),Z=n(55585),v=n(14267),y=n(4869),_=n(3797),b=n(99743),E=n(54214),P=n(46417),C=function(e){var t=e.voucher,n=e.editVoucherStatus,r=function(){return(0,P.jsx)(_.Z,{permission:b._.VOUCHER_REJECT,children:(0,P.jsx)(j.Z,{variant:"outlined",color:"error",onClick:function(){return n(E._i.REJECT)},children:"Reject"})})};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(i.ZP,{container:!0,spacing:4,mb:3,mt:1,children:[(0,P.jsxs)(i.ZP,{item:!0,xs:7,children:[(0,P.jsx)(f.Z,{children:"Voucher details"}),(0,P.jsx)(i.ZP,{container:!0,spacing:4,mb:3,mt:1,children:(0,P.jsx)(i.ZP,{item:!0,xs:12,children:(0,P.jsx)(g.k,{title:"Voucher Title",value:t.title})})}),(0,P.jsx)(i.ZP,{container:!0,children:(0,P.jsx)(i.ZP,{item:!0,xs:12,children:(0,P.jsx)(g.k,{title:"Voucher Details",value:(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(s.Z,{children:(0,P.jsx)(m.Z,{variant:"h6",children:t.details})})})})})})]}),(0,P.jsxs)(i.ZP,{item:!0,xs:5,children:[(0,P.jsx)(f.Z,{children:"Voucher details"}),t.status===l.SU.REJECTED?(0,P.jsx)(Z.ZP,{status:"error",title:"Rejected",subTitle:(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)(P.Fragment,{children:["Rejected by"," ",(0,P.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",t.rejected_by.first_name," ",t.rejected_by.last_name]})," ","at ",(0,P.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",(0,c.gg)(t.rejected_at)," "]})]})})}):(0,P.jsx)(v.Z,{voucher:t})]})]}),(0,P.jsx)(y.Z,{amount:t.amount}),(0,P.jsx)(i.ZP,{container:!0,spacing:4,mb:3,mt:1,alignItems:"center",justifyContent:"flex-end",children:(0,P.jsxs)(p.Z,{spacing:2,direction:"row",children:[(0,P.jsxs)(_.Z,{permission:b._.VOUCHER_VERIFY,withOtherDeps:function(){return t.status===l.SU.PENDING},children:[(0,P.jsx)(r,{}),(0,P.jsx)(j.Z,{variant:"outlined",color:"info",onClick:function(){return n(E._i.VERIFY)},children:"Verify"})]}),(0,P.jsxs)(_.Z,{permission:b._.VOUCHER_APPROVE,withOtherDeps:function(){return t.status===l.SU.VERIFIED},children:[(0,P.jsx)(r,{}),(0,P.jsx)(j.Z,{variant:"outlined",color:"success",onClick:function(){return n(E._i.APPROVE)},children:"Approve"})]}),(0,P.jsxs)(_.Z,{permission:b._.VOUCHER_PAY,withOtherDeps:function(){return t.status===l.SU.APPROVED},children:[(0,P.jsx)(r,{}),(0,P.jsx)(j.Z,{variant:"outlined",color:"primary",onClick:function(){return n(E._i.PAYMENTS)},children:"Paid"})]})]})})]})},R=n(29814),F=n(8105),S=n(71415),V=function(e){var t=e.voucher,n=(0,u.useState)(!0),s=(0,r.Z)(n,2),o=s[0],c=s[1],a=(0,u.useState)([]),l=(0,r.Z)(a,2),d=l[0],j=l[1];return(0,u.useEffect)((function(){(0,h.Bl)(t.id).then((function(e){console.log(e),j(e),c(!1)})).catch((function(e){console.log(e),x.Z.warning("Failed to load attachments")}))}),[]),(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(R.Ae,{isLoading:o,children:0===d.length?(0,P.jsx)(F.Z,{description:"No attachments"}):(0,P.jsx)(i.ZP,{container:!0,mb:3,mt:1,alignItems:"center",justifyContent:"flex-start",children:(0,P.jsx)(S.Z,{attachments:d})})})})},A=[{label:(0,P.jsx)("div",{style:{padding:4},children:"Details"}),value:l.sy.DETAILS},{label:(0,P.jsx)("div",{style:{padding:4},children:"Attachments"}),value:l.sy.ATTACHMENTS}],D=function(){var e=(0,u.useState)(!0),t=(0,r.Z)(e,2),n=t[0],j=t[1],f=(0,u.useState)(null),m=(0,r.Z)(f,2),p=m[0],g=m[1],Z=(0,u.useState)(l.sy.DETAILS),v=(0,r.Z)(Z,2),y=v[0],_=v[1],b=(0,u.useState)(!1),F=(0,r.Z)(b,2),S=F[0],D=F[1],T=(0,u.useState)(null),I=(0,r.Z)(T,2),O=I[0],k=I[1],w=(0,d.s0)(),N=(0,d.UO)(),U=function(){(0,h.JN)(N.voucher_id).then((function(e){g(e),j(!1)})).catch((function(e){x.Z.error("Failed to load Voucher details"),w("/vouchers",{replace:!0})}))};(0,u.useEffect)((function(){U()}),[]);return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(R.tv,{isLoading:n,children:null!==p&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(s.Z,{title:(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)(i.ZP,{container:!0,spacing:3,alignItems:"center",children:[(0,P.jsxs)(i.ZP,{item:!0,xs:3,children:["Voucher Number: #",p.voucher_number]}),(0,P.jsx)(i.ZP,{item:!0,xs:12,md:6,lg:6,sx:{ml:"auto"},children:(0,P.jsx)(i.ZP,{container:!0,alignItems:"center",justifyContent:"flex-end",pr:2,children:(0,c.AB)(p.status)})})]})}),content:!1,border:!1,boxShadow:!0,children:(0,P.jsxs)(o.Z,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:[(0,P.jsx)(i.ZP,{container:!0,spacing:4,mb:3,mt:1,alignItems:"center",justifyContent:"center",children:(0,P.jsx)(a.Z,{style:{width:"60%"},block:!0,options:A,onChange:function(e){_(e)}})}),y===l.sy.DETAILS&&(0,P.jsx)(C,{voucher:p,editVoucherStatus:function(e){return k(e),void D(!0)}}),y===l.sy.ATTACHMENTS&&(0,P.jsx)(V,{voucher:p})]})}),null!==O&&S?(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(E.fL,{open:S,setOpen:D,request_type:E.XN.VOUCHER,unique_identifier:p.voucher_number,action:O,onConfirm:function(){var e={status:O.value};return(0,h.b6)(N.voucher_id,e).then((function(e){return console.log(e),x.Z.success("Voucher status updated successfully"),U(),k(null),!0})).catch((function(e){return x.Z.error("Failed to updated Voucher status"),console.log(e),!1}))}})}):(0,P.jsx)(P.Fragment,{})]})})})}},14267:function(e,t,n){var r=n(81190),s=n(75697),i=n(61805),o=n(46417);t.Z=function(e){var t=e.voucher;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.Z,{progressDot:!0,current:t.status,direction:"vertical",items:[{title:"Requested",description:(0,o.jsxs)(o.Fragment,{children:["Requested by"," ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",t.created_by.first_name," ",t.created_by.last_name]})," ","at ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",(0,s.gg)(t.created_at)," "]})]})},{title:"Verified",description:(0,o.jsx)(o.Fragment,{children:t.status>=i.SU.VERIFIED&null!==t.verified_by?(0,o.jsxs)(o.Fragment,{children:[" ","Verified_by"," ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",t.verified_by.first_name," ",t.verified_by.last_name]})," ","at ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",(0,s.gg)(t.verified_at)," "]})," "]}):"Not verified"})},{title:"Approved",description:(0,o.jsx)(o.Fragment,{children:t.status>=i.SU.APPROVED&&null!==t.approved_by?(0,o.jsxs)(o.Fragment,{children:[" ","Approved by"," ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",t.approved_by.first_name," ",t.approved_by.last_name]})," ","at ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",(0,s.gg)(t.approved_at)," "]})]}):"Not Aprroved"})},{title:"Paid",description:(0,o.jsx)(o.Fragment,{children:t.status===i.SU.PAID&&null!==t.paid_by?(0,o.jsxs)(o.Fragment,{children:[" ","Payments done by"," ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",t.paid_by.first_name," ",t.paid_by.last_name]})," ","at ",(0,o.jsxs)("span",{style:{fontWeight:"bold"},children:[" ",(0,s.gg)(t.paid_at)," "]})]}):"No payments done"})}]})})}}}]);