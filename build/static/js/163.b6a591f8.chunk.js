"use strict";(self.webpackChunkioms_web=self.webpackChunkioms_web||[]).push([[163],{75697:function(e,n,r){r.d(n,{An:function(){return h},CI:function(){return u},Rn:function(){return m},Tj:function(){return c},Vo:function(){return p},gg:function(){return d},oB:function(){return f},un:function(){return g}});var t=r(61805),i=r(66212),o=r(22098),a=r(54427),l=r(77841),s=r(46417),u=function(e){return e?(0,s.jsx)(i.Z,{color:"success",label:"Taken"}):(0,s.jsx)(i.Z,{color:"primary",label:"Open"})},c=function(e){return e===t.yd.PENDING?(0,s.jsx)(i.Z,{color:"secondary",label:"Pending"}):e===t.yd.ACCEPTED?(0,s.jsx)(i.Z,{color:"success",label:"Accepted"}):e===t.yd.REJECTED?(0,s.jsx)(i.Z,{color:"error",label:"Rejected"}):void 0},d=function(e){return new Date(e).toLocaleString()},h=function(e){return 1===e?"Admin":2===e?"User":void 0},m=function(e){(0,o.nD)().then((function(n){console.log(n),e(n)})).catch((function(e){console.log(e)}))},f=function(e){return e.toLocaleString("en-US",{style:"currency",currency:"TZS"})},p=function(e){e.response?401===e.response.status?(l.Z.error("Unauthorized request, please login again"),null!==a.VK&&(0,a.VK)("/login",{replace:!0}),localStorage.clear()):400===e.response.status||500===e.response.status||e.response&&429===e.response.status||console.log("Error occurred, status: "+e.response.status):l.Z.error("No network available, Please connect to a Network")};function g(e){var n=e.slice(0,3),r=e.slice(3);return 9===r.length?{countryCode:n,phoneNumber:r}:{countryCode:"255",phoneNumber:"1".repeat(9)}}},77841:function(e,n,r){var t=r(15671),i=r(43144),o=r(54427),a=function(){function e(){(0,t.Z)(this,e)}return(0,i.Z)(e,[{key:"success",value:function(e){o.sp&&o.sp.enqueueSnackbar(e,{variant:"success"})}},{key:"error",value:function(e){o.sp&&o.sp.enqueueSnackbar(e,{variant:"error"})}},{key:"warning",value:function(e){o.sp&&o.sp.enqueueSnackbar(e,{variant:"warning"})}}]),e}();n.Z=new a},99163:function(e,n,r){r.r(n);var t=r(70885),i=r(58467),o=r(22778),a=r(47313),l=r(75697),s=r(22098),u=r(77841),c=r(97402),d=r(57829),h=r(46417);n.default=function(){var e=(0,a.useState)([]),n=(0,t.Z)(e,2),r=n[0],m=n[1],f=(0,a.useState)(null),p=(0,t.Z)(f,2),g=p[0],x=p[1],Z=(0,a.useState)(!1),v=(0,t.Z)(Z,2),b=v[0],j=(v[1],(0,a.useState)(!0)),_=(0,t.Z)(j,2),S=_[0],y=_[1],w=(0,i.UO)(),k=(0,i.s0)();return(0,a.useEffect)((function(){(0,l.Rn)(m),(0,s.gi)(w.user_id).then((function(e){x({first_name:e.first_name,last_name:e.last_name,cellphone:(0,l.un)(e.cellphone).phoneNumber,email:e.email,role:null!==e.role?e.role.id:""}),y(!1)})).catch((function(e){console.log(e),u.Z.error("Failed to load user details"),k("/users",{replace:!0})}))}),[]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(c.Z,{title:"Editing a User",content:!1,border:!1,boxShadow:!0,children:(0,h.jsx)(d.Z,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:!S&&(0,h.jsx)(o.Z,{initialValues:g,role_options:r,onSubmitForm:function(e){return function(e){(0,s.Um)(w.user_id,e).then((function(e){console.log(e),u.Z.success("User details edited successfully"),k("/users",{replace:!0})})).catch((function(e){console.log(e),u.Z.error("Failed to edit user details")}))}(e)},initial_role:g.role,loading:b})})})})}},22778:function(e,n,r){var t=r(74165),i=r(15861),o=r(70885),a=r(9019),l=r(42832),s=r(23306),u=r(37843),c=r(15480),d=r(41727),h=r(24256),m=r(51405),f=r(7410),p=r(28089),g=r(69490),x=r(51406),Z=r(47313),v=r(46417);n.Z=function(e){var n=e.onSubmitForm,r=e.role_options,b=e.loading,j=e.initial_role,_=void 0===j?"":j,S=e.initialValues,y=void 0===S?null:S,w=(0,Z.useState)(_),k=(0,o.Z)(w,2),P=k[0],C=k[1],E=(0,Z.useState)(!1),N=(0,o.Z)(E,2),A=N[0],F=N[1],T=(0,Z.useState)("255"),q=(0,o.Z)(T,2),B=q[0];q[1];return console.log("Initial Values",y),(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(f.J9,{initialValues:null===y?{first_name:"",last_name:"",cellphone:"",email:"",role:""}:y,validationSchema:p.Ry().shape({email:p.Z_().email("Must be a valid email").max(255).required("Email is required"),first_name:p.Z_().max(255).required("First Name is required"),last_name:p.Z_().max(255).required("Last Name is required"),cellphone:p.Z_().max(9).min(9).required("Phone Number is required")}),onSubmit:function(){var e=(0,i.Z)((0,t.Z)().mark((function e(r,i){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.setErrors,i.setStatus,i.setSubmitting,""!==P&&(r.role=P,r.cellphone="255".concat(r.cellphone),n(r));case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),children:function(e){var n=e.errors,t=e.handleBlur,i=e.handleChange,o=e.handleSubmit,f=(e.isSubmitting,e.touched),p=e.values;return(0,v.jsxs)("form",{noValidate:!0,onSubmit:function(e){F(""===P),o(e)},children:[(0,v.jsxs)(a.ZP,{container:!0,spacing:3,mb:3,children:[(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsxs)(l.Z,{spacing:1,children:[(0,v.jsx)(s.Z,{htmlFor:"bootstrap",children:"First Name"}),(0,v.jsx)(u.Z,{id:"email-login",type:"text",value:p.first_name,name:"first_name",onBlur:t,onChange:i,placeholder:"eg. John",fullWidth:!0,error:Boolean(f.first_name&&n.first_name)}),f.first_name&&n.first_name&&(0,v.jsx)(c.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:n.first_name})]})}),(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsxs)(l.Z,{spacing:1,children:[(0,v.jsx)(s.Z,{htmlFor:"bootstrap",children:"Last Name"}),(0,v.jsx)(u.Z,{id:"email-login",type:"text",value:p.last_name,name:"last_name",onBlur:t,onChange:i,placeholder:"eg. Doe",fullWidth:!0,error:Boolean(f.last_name&&n.last_name)}),f.last_name&&n.last_name&&(0,v.jsx)(c.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:n.last_name})]})})]}),(0,v.jsxs)(a.ZP,{container:!0,spacing:3,mb:3,children:[(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsxs)(l.Z,{spacing:1,children:[(0,v.jsx)(s.Z,{htmlFor:"bootstrap",children:"Phone Number"}),(0,v.jsx)(u.Z,{id:"email-login",type:"number",value:p.cellphone,name:"cellphone",onBlur:t,onChange:i,placeholder:"eg. 7111...",fullWidth:!0,style:{padding:0},startAdornment:(0,v.jsxs)(d.Z,{style:{padding:0},position:"start",children:[" ",(0,v.jsx)(h.Z,{labelId:"demo-simple-select-helper-label",id:"demo-simple-select-helper",value:B,onChange:i,children:(0,v.jsx)(m.Z,{value:"255",children:"+255"})})]}),error:Boolean(f.cellphone&&n.cellphone)}),f.cellphone&&n.cellphone&&(0,v.jsx)(c.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:n.cellphone})]})}),(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsxs)(l.Z,{spacing:1,children:[(0,v.jsx)(s.Z,{htmlFor:"bootstrap",children:"Email Address"}),(0,v.jsx)(u.Z,{id:"email-login",type:"email",value:p.email,name:"email",onBlur:t,onChange:i,placeholder:"eg. example@gmail.com",fullWidth:!0,error:Boolean(f.email&&n.email)}),f.email&&n.email&&(0,v.jsx)(c.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:n.email})]})})]}),(0,v.jsxs)(a.ZP,{container:!0,spacing:3,mb:3,children:[(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsxs)(l.Z,{spacing:1,children:[(0,v.jsx)(s.Z,{htmlFor:"bootstrap",children:"Role"}),(0,v.jsx)(h.Z,{labelId:"demo-simple-select-disabled-label",id:"demo-simple-select-disabled",value:P,onChange:function(e){F(!1),C(e.target.value)},error:Boolean(A),children:r.map((function(e,n){return(0,v.jsx)(m.Z,{value:e.id,children:e.title},n)}))}),A&&(0,v.jsx)(c.Z,{error:!0,id:"standard-weight-helper-text-email-login",children:"Select Role"})]})}),n.submit&&(0,v.jsx)(a.ZP,{item:!0,xs:12,children:(0,v.jsx)(c.Z,{error:!0,children:n.submit})})]}),(0,v.jsx)(a.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",mg:3,children:(0,v.jsx)(a.ZP,{item:!0,xs:6,children:(0,v.jsx)(g.Z,{children:(0,v.jsx)(x.Z,{disableElevation:!0,disabled:b,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",loading:b,children:"Submit"})})})})]})}})})}},22098:function(e,n,r){r.d(n,{LK:function(){return _},kA:function(){return x},bu:function(){return Z},Um:function(){return p},Bf:function(){return j},Ar:function(){return b},vU:function(){return v},nD:function(){return g},gi:function(){return f},rW:function(){return h},Qb:function(){return c},OP:function(){return m},yi:function(){return S},vy:function(){return d}});var t=r(56573),i="http://161.35.210.153:8500/",o=r(75697);function a(e,n){return new Promise((function(r,a){t.Z.post(i+e,n).then((function(e){e.headers,r(e.data)})).catch((function(e){(0,o.Vo)(e),a(e)}))}))}function l(e){return new Promise((function(n,r){t.Z.get(i+e,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){n(e.data)})).catch((function(e){(0,o.Vo)(e),r(e)}))}))}function s(e,n){return new Promise((function(r,a){t.Z.post(i+e,n,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){r(e.data)})).catch((function(e){(0,o.Vo)(e),a(e)}))}))}function u(e,n){return new Promise((function(r,a){t.Z.put(i+e,n,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){r(e.data)})).catch((function(e){(0,o.Vo)(e),a(e)}))}))}function c(e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",t={};return""!==r&&(t.mfaCode=r),a("api/auth/login-user",{email:e,password:n},!1)}function d(e,n,r){var t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i={};return""!==t&&(i.mfaCode=t),s("api/auth/reset-password/"+r,{password:e,confirm_password:n},!1)}function h(){return l("api/v1/users-list/")}function m(e){return s("api/v1/register-user",e)}function f(e){return l("api/v1/user/"+e)}function p(e,n){return u("api/v1/user/"+e,n)}function g(){return l("api/v1/roles")}function x(e){return s("api/v1/roles",e)}function Z(e,n){return u("api/v1/role/"+e,n)}function v(e){return l("api/v1/role/"+e)}function b(){return l("api/v1/hostels-list/")}function j(){return l("api/v1/booked-hostels-list/")}function _(e){return u("api/v1/accept-hostel-book/"+e,{})}function S(e){return u("api/v1/reject-hostel-book/"+e,{})}},61805:function(e,n,r){r.d(n,{J:function(){return i},yd:function(){return t}});var t={PENDING:0,ACCEPTED:1,REJECTED:2},i={TODAY:"today",THIS_WEEK:"this_week",MONTHLY:"monthly"}}}]);